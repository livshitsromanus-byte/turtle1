<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt-stdlib.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt-turtle.min.js"></script>

</head>
<body>

<textarea id="yourcode" cols="40" rows="10">
import turtle

t = turtle.Turtle()
t.forward(150)
</textarea>

<button onclick="runit()">Run</button>

<pre id="output"></pre>

<canvas id="mycanvas" width="500" height="400" style="border:1px solid black"></canvas>

<script>
function outf(text) {
    document.getElementById("output").innerHTML += text;
}

function builtinRead(x) {
    if (!Sk.builtinFiles || !Sk.builtinFiles["files"][x])
        throw "File not found: '" + x + "'";
    return Sk.builtinFiles["files"][x];
}

function runit() {

    document.getElementById("output").innerHTML = "";

    Sk.configure({
        output: outf,
        read: builtinRead,
        __future__: Sk.python3,     // ✔ ВКЛЮЧАЕМ PYTHON3 БЕЗ СЛОМАННОГО python3:true
        turtlecanvas: "mycanvas"
    });

    (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = "mycanvas";

    Sk.misceval.asyncToPromise(() =>
        Sk.importMainWithBody("<stdin>", false, yourcode.value)
    ).catch(err => outf(err.toString()));
}
</script>

</body>
</html>
